{"version":3,"file":"local.strategy.js","names":["require","Strategy","boom","bcrypt","User","LocalStrategy","username","password","done","findOne","findUser","unauthorized","compare","isMatch","module","exports"],"sources":["../../../../src/helpers/auth/strategies/local.strategy.js"],"sourcesContent":["const { Strategy } = require('passport-local')\nconst boom = require('@hapi/boom');\nconst bcrypt = require('bcryptjs')\nconst User = require('../../../models/user.model');\n\n\nconst LocalStrategy = new Strategy(async (username, password, done) => {\n    try {\n        const findUser = await User.findOne({ username: username })\n        if (findUser == null) {\n            done(boom.unauthorized(), false)\n        }\n        const isMatch = await bcrypt.compare(password, findUser.password);\n        if (!isMatch) {\n            done(boom.unauthorized(), false)\n        }\n        done(null, findUser)\n\n    } catch (error) {\n        done(error, false);\n    }\n});\n\n\nmodule.exports = LocalStrategy"],"mappings":";;;;+CACA,oJ;;;;;;AADA,eAAqBA,OAAO,CAAC,gBAAD,CAA5B;AAAA,IAAQC,QAAR,YAAQA,QAAR;;AACA,IAAMC,IAAI,GAAGF,OAAO,CAAC,YAAD,CAApB;;AACA,IAAMG,MAAM,GAAGH,OAAO,CAAC,UAAD,CAAtB;;AACA,IAAMI,IAAI,GAAGJ,OAAO,CAAC,4BAAD,CAApB;;AAGA,IAAMK,aAAa,GAAG,IAAIJ,QAAJ;EAAA,sEAAa,iBAAOK,QAAP,EAAiBC,QAAjB,EAA2BC,IAA3B;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA;YAAA,OAEJJ,IAAI,CAACK,OAAL,CAAa;cAAEH,QAAQ,EAAEA;YAAZ,CAAb,CAFI;;UAAA;YAErBI,QAFqB;;YAG3B,IAAIA,QAAQ,IAAI,IAAhB,EAAsB;cAClBF,IAAI,CAACN,IAAI,CAACS,YAAL,EAAD,EAAsB,KAAtB,CAAJ;YACH;;YAL0B;YAAA,OAMLR,MAAM,CAACS,OAAP,CAAeL,QAAf,EAAyBG,QAAQ,CAACH,QAAlC,CANK;;UAAA;YAMrBM,OANqB;;YAO3B,IAAI,CAACA,OAAL,EAAc;cACVL,IAAI,CAACN,IAAI,CAACS,YAAL,EAAD,EAAsB,KAAtB,CAAJ;YACH;;YACDH,IAAI,CAAC,IAAD,EAAOE,QAAP,CAAJ;YAV2B;YAAA;;UAAA;YAAA;YAAA;YAa3BF,IAAI,cAAQ,KAAR,CAAJ;;UAb2B;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAb;;EAAA;IAAA;EAAA;AAAA,IAAtB;AAkBAM,MAAM,CAACC,OAAP,GAAiBV,aAAjB"}