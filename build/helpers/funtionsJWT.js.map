{"version":3,"file":"funtionsJWT.js","names":["jwt","require","generateJWT","uid","Promise","resolve","reject","payload","sign","process","env","SECRET_KEY","expiresIn","err","token","console","log","verifyJWT","verify","decoded","isBoom","output","statusCode","error","message","expired","module","exports"],"sources":["../../src/helpers/funtionsJWT.js"],"sourcesContent":["const jwt = require('jsonwebtoken');\n\nconst generateJWT = (uid = '') => {\n\n    return new Promise((resolve, reject) => {\n        const payload = { uid };\n\n        jwt.sign(payload, process.env.SECRET_KEY, {\n            expiresIn: '6h'\n        }, (err, token) => {\n            if (err) {\n                console.log(err);\n                reject('No se pudo generar el token');\n            } else {\n                resolve(token);\n            }\n        })\n    })\n\n}\n\nconst verifyJWT = (token = '') => {\n\n    return new Promise((resolve, reject) => {\n        const payload = token;\n        jwt.verify(payload, process.env.SECRET_KEY, (err, decoded) => {\n            if (err) {\n                reject(\n                    {\n                        isBoom: true,\n                        output: {\n                            statusCode: 400,\n                            payload: {\n                                statusCode: 400,\n                                error: \"Bad Request\",\n                                message: 'Token Invalido',\n                                expired: true\n                            }\n                        }\n\n                    }\n                );\n            } else {\n                resolve(decoded);\n            }\n        })\n    })\n}\n\nmodule.exports = {\n    generateJWT,\n    verifyJWT\n}"],"mappings":";;AAAA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,GAAc;EAAA,IAAbC,GAAa,uEAAP,EAAO;EAE9B,OAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;IACpC,IAAMC,OAAO,GAAG;MAAEJ,GAAG,EAAHA;IAAF,CAAhB;IAEAH,GAAG,CAACQ,IAAJ,CAASD,OAAT,EAAkBE,OAAO,CAACC,GAAR,CAAYC,UAA9B,EAA0C;MACtCC,SAAS,EAAE;IAD2B,CAA1C,EAEG,UAACC,GAAD,EAAMC,KAAN,EAAgB;MACf,IAAID,GAAJ,EAAS;QACLE,OAAO,CAACC,GAAR,CAAYH,GAAZ;QACAP,MAAM,CAAC,6BAAD,CAAN;MACH,CAHD,MAGO;QACHD,OAAO,CAACS,KAAD,CAAP;MACH;IACJ,CATD;EAUH,CAbM,CAAP;AAeH,CAjBD;;AAmBA,IAAMG,SAAS,GAAG,SAAZA,SAAY,GAAgB;EAAA,IAAfH,KAAe,uEAAP,EAAO;EAE9B,OAAO,IAAIV,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;IACpC,IAAMC,OAAO,GAAGO,KAAhB;IACAd,GAAG,CAACkB,MAAJ,CAAWX,OAAX,EAAoBE,OAAO,CAACC,GAAR,CAAYC,UAAhC,EAA4C,UAACE,GAAD,EAAMM,OAAN,EAAkB;MAC1D,IAAIN,GAAJ,EAAS;QACLP,MAAM,CACF;UACIc,MAAM,EAAE,IADZ;UAEIC,MAAM,EAAE;YACJC,UAAU,EAAE,GADR;YAEJf,OAAO,EAAE;cACLe,UAAU,EAAE,GADP;cAELC,KAAK,EAAE,aAFF;cAGLC,OAAO,EAAE,gBAHJ;cAILC,OAAO,EAAE;YAJJ;UAFL;QAFZ,CADE,CAAN;MAeH,CAhBD,MAgBO;QACHpB,OAAO,CAACc,OAAD,CAAP;MACH;IACJ,CApBD;EAqBH,CAvBM,CAAP;AAwBH,CA1BD;;AA4BAO,MAAM,CAACC,OAAP,GAAiB;EACbzB,WAAW,EAAXA,WADa;EAEbe,SAAS,EAATA;AAFa,CAAjB"}